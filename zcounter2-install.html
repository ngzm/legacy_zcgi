<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<meta http-equiv="Content-Style-Type" content="text/css"> 
<meta name="author" content="N.ZUMIN">
<meta name="description" content="人口無能ほか各種CGIフリーソフト提供など">
<meta name="keywords" content="ZUMIN、UNIX、Linux、人口無能、CGI、Perl、フリーソフト">
<link rel="stylesheet" type="text/css" href="/style/zumin.css" media="screen, projection, print">

<title>Ｚカウンター２号</title>
</head>

<body>
<address>
[ <a class="magenda" href="/">HOME</a> ]
[ <a class="magenda" href="index.html">戻る</a> ]
</address>
zcounter2 Ver.1.1.1 2003/02/15

<h1>Ｚカウンター２号</h1>
<div class="content">

<!-- ============================================================================================= -->
<h3 class="blue">Ｚカウンター２号とは</h3>
<ul>
	<li>Zumin カウンター２号機です。
	<li>Ｚカウンター２号は、GIFイメージのアクセスカウンターです。
	<li>サーバー上の CGI で GIFイメージを一気に連結して送信するため高速です。
	<li>同一IPアドレスのチェック（オプション）機能により、リロードなどによる無意味なカウントアップを抑制します。
	<li>SSI は使用しません。SSI 非対応のサイトでも問題ありません。
	<li>アクセスカウンターにプラスして管理機能が付いています。
	<li>管理機能では、アクセス日時やアクセスしてきたホストなどのアクセスログが収集できます。
	<li>管理機能では、アクセスログの参照、ダウンロード、削除ができます。
	<li>管理メニューはパスワード認証が必要ですので管理者以外は入れません。
	<li>管理メニューは一度認証されるとクッキーに保存されるため、次回から認証パスワードを入力する手間が省けます。
</ul>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">こんな感じです</h3>

<blockquote>
	<img src="demo/zcounter2/counter_img/left.gif"><img src="demo/zcounter2/zcounter2.cgi"><img src="demo/zcounter2/counter_img/right.gif">
</blockquote>

<ul>
	<li>このサンプルは、デモ版なので同一IPアドレスのチェックは外しています。
	<li>同様にデモ版なので、管理メニュー内の表示内容（アクセスしてきたIPアドレスなど）も表示できません。
	<li><a href="demo/zcounter2/zc2adm.cgi">管理メニューここから</a> （パスワードは guest です）
</ul>

<blockquote>
カウンターGIFは<a href="http://www10.big.or.jp/~gayou/nmr/nmr.html" target="zumin">なまらさん</a>作のカウンター画像を利用しています。
この他にも沢山のカウンター画像があってお薦めのサイトです。
<p>
<a href="http://www10.big.or.jp/~gayou/nmr/nmr.html" target="zumin">
<img src="../banner/namarane01-200-40.jpg">
</a>
</blockquote>

<br>
<!-- ============================================================================================= -->
<h3 class="blue">動作条件</h3>
<ul>
	<li>ホームページがあるサーバーでPerlを使用したCGIが使えること。
	<li>Perlのバージョンが 5（Perl5）以上であること。
	<li>ホームページがあるサーバーのOSがLinux、UNIXであり、Web Server が Apache で動作確認しています。
	<li>上記以外では動作確認していません。あしからずご了承ください。
</ul>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">ここからダウンロードできます</h3>
<ul>
	<li>Windowsな人 <a href="download/zcounter2.exe">自己解凍形式(EXE)</a>
	<li>Windowsな人 <a href="download/zcounter2.zip">ZIP形式</a>
	<li>Linux、UNIXな人（準備中）
	<li>ダウンロードしたら自分のローカルマシン上で解凍してください。
	<li>必ず、ディレクトリ付きで解凍してください。
</ul>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">ディレクトリ・ファイル構成</h3>
<pre>
        (注） . はカレントディレクトリ

        ./zcounter2.cgi          ---  Ｚカウンター２号CGI本体プログラム
        ./zc2adm.cgi             ---  アクセスログ管理CGI本体プログラム
        ./userdef.pm             ---  ユーザー環境設定ファイル

        ./lib/                   ---  【ディレクトリ】 ライブラリプログラム格納   
        ./lib/zcounter2.pm       ---  Ｚカウンター２号ライブラリプログラム
        ./lib/zc2adm.pm          ---  アクセスログ管理ライブラリプログラム
        ./lib/zcgi.pm            ---  CGI関連ライブラリプログラム
        ./lib/jcode.pl           ---  日本語文字操作プログラム
        ./lib/gifcat.pl          ---  GIFイメージ操作プログラム（とほほさん著作）

        ./counter_img/           ---  【ディレクトリ】 カウンターGIF格納
        ./counter_img/zero.gif   ---  カウンターGIFファイル [ 0 ]
        ./counter_img/one.gif    ---  カウンターGIFファイル [ 1 ]
        ./counter_img/two.gif    ---  カウンターGIFファイル [ 2 ]
        ./counter_img/three.gif  ---  カウンターGIFファイル [ 3 ]
        ./counter_img/four.gif   ---  カウンターGIFファイル [ 4 ]
        ./counter_img/five.gif   ---  カウンターGIFファイル [ 5 ]
        ./counter_img/six.gif    ---  カウンターGIFファイル [ 6 ]
        ./counter_img/seven.gif  ---  カウンターGIFファイル [ 7 ]
        ./counter_img/eight.gif  ---  カウンターGIFファイル [ 8 ]
        ./counter_img/nine.gif   ---  カウンターGIFファイル [ 9 ]

        ./data/                  ---  【ディレクトリ】 カウンターデータ格納
        ./data/error.gif         ---  エラー表示用GIF
</pre>
<ul>
	<li>以上のディレクトリ・ファイルがあれば、うまく解凍できています。
	<li>カウンター設置のためには、ユーザー環境設定ファイル [userdef.pm] でお好みの設定を定義します。
</ul>

<blockquote>
ダウンロードパッケージに含まれるカウンターGIFファイル [counter_img/XXX.gif]は、
こちらで用意している、ずうみん村サイトの <a href="http://zumin.cside9.com/yuuri/" target="zumin">ゆうり</a>作
サンプルですので、お好みのカウンター GIF と入れ替えてください。
<p>
<a href="http://zumin.cside9.com/yuuri/" target="zumin">
<img src="../banner/banner_yuuri.gif">
</a>
</blockquote>

<br>
<!-- ============================================================================================= -->
<h3 class="blue">カウンターGIFファイルの用意</h3>
<ul>
	<li>これだ！と思うカウンター用GIFファイルをカウンターGIF格納ディレクトリ[ counter_img ] に格納します。
	<li>カウンター用GIFファイルは、0〜9までの数字毎にファイル名が決まっています。間違わないように気をつけてください！
</ul>
<pre>
        ./counter_img/zero.gif   ---  [ 0 ] のGIFファイル
        ./counter_img/one.gif    ---  [ 1 ] のGIFファイル
        ./counter_img/two.gif    ---  [ 2 ] のGIFファイル
        ./counter_img/three.gif  ---  [ 3 ] のGIFファイル
        ./counter_img/four.gif   ---  [ 4 ] のGIFファイル
        ./counter_img/five.gif   ---  [ 5 ] のGIFファイル
        ./counter_img/six.gif    ---  [ 6 ] のGIFファイル
        ./counter_img/seven.gif  ---  [ 7 ] のGIFファイル
        ./counter_img/eight.gif  ---  [ 8 ] のGIFファイル
        ./counter_img/nine.gif   ---  [ 9 ] のGIFファイル
</pre>
<ul>
	<li>カウンターGIFファイルは、素材やさんのサイトからダウンロードするか、ご自分で作成されても良いと思います。
	<li>但し、GIF形式で保存された画像に限ります。
	<li>カウンターGIFの解像度が大きいほど、GIFファイル連結処理やネットワーク転送処理で時間がかかりますので非効率です。
</ul>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">ユーザー環境設定ファイルの編集 [ userdef.pm ]</h3>
<ul>
	<li>ユーザー環境設定ファイル [ userdef.pm ] をメモ帳などのテキストエディタで開いて編集します。
	<li>設定できる項目は以下の 7 項目です。
	<ol>
		<li>あなたのホームページのHOMEへのURL [ $HomeURL ]
		<li>カウンターの表示桁数 [ $CounterSize ]
		<li>同一IPアドレスのチェック [ $CheckHomonymIp ]
		<li>同一IPアドレスのチェック時に適用される時間間隔 [ $NoCountSpan ]
		<li>アクセスログ件数上限 [ $AccessLogMax ]
        <li>アクセスログ管理ツールアクセス時パスワード [ $AdminPasswd ]
        <li>パスワード暗号化キー [ $CriptKey ]
	</ol>
</ul>
<pre><code>
    ==== userdef.pm ====
        ..
        ..
        ###################################################################
        #
        #   カスタマイズ可能変数（お好みで書き換え可）
        #
        ###################################################################

        # ===========================================================
        #               ☆☆☆ $HomeURL ☆☆☆
        # ----------------------------------------------------
        #  あなたのホームページのHOMEへのURLです。
        # ===========================================================
        $HomeURL = '/YourHomePage/index.html';


        # ===========================================================
        #               ☆☆☆ $CounterSize ☆☆☆
        # ----------------------------------------------------
        #  カウンターの表示桁数です。
        #  1 以上、16 以内で設定してください。
        #  上記範囲外ですとディフォルトの 6 桁となります。
        # ===========================================================
        $CounterSize = 5;


        # ===========================================================
        #               ☆☆☆ $CheckHomonymIp ☆☆☆
        # ----------------------------------------------------
        #  同一IPアドレスの場合はカウントしないようプログラム
        #  でチェックする設定です。
        # ----------------------------------------------------
        #   1 : チェックします。
        #       同一IPアドレスの場合はカウントしなくなります。
        #   0 : チェックしません。
        #       同一IPアドレスの場合でもカウントします。
        # ===========================================================
        $CheckHomonymIp = 1;


        # ===========================================================
        #               ☆☆☆ $NoCountSpan ☆☆☆
        # ----------------------------------------------------
        #  同一IPアドレスのチェックするとき、前回のアクセス
        #  から一定時間経過したら、たとえ、同一IPアドレスか
        #  らのアクセスであってもカウンタを進めたい場合に、
        #  その一定時間を分（Minutes)で設定できます。
        # ----------------------------------------------------
        #   注意：
        #   上記、$CheckHomonymIp を 0 に設定した場合、ここ
        #   にどんな値を設定しても無効です。
        # ----------------------------------------------------
        #   注意：
        #   上記、$CheckHomonymIp を 1 に設定し、且つ、
        #   $NoCountSpan を 0 に設定した場合は、何時間たって
        #   も、他の誰か、つまり、異なるIPアドレスからのアク
        #   セスがない限り、カウンタは進みません。
        # ===========================================================
        $NoCountSpan = 15;


        # ===========================================================
        #               ☆☆☆ $AccessLogMax ☆☆☆
        # ----------------------------------------------------
        #  アクセスログ件数上限
        #  この上限値を超えるタイミングで、アクセスログが一旦
        #  クリアされます。それまでのログは破棄されます。
        # ===========================================================
        $AccessLogMax = 1024;


        # ===========================================================
        #               ☆☆☆ $AdminPasswd ☆☆☆
        # ----------------------------------------------------
        #  アクセスログ管理ツールアクセス時パスワード
        # ----------------------------------------------------
        #  アクセスログ管理ツールを使用する場合このパスワード
        #  で管理者の認証をおこないます。
        #  他人から盗まれないよう注意してください。
        # ----------------------------------------------------
        #  英数字（ASCII)4桁〜16桁で指定してください。
        # ===========================================================
        $AdminPasswd = 'admin';

        # ===========================================================
        #               ☆☆☆ $CriptKey ☆☆☆
        # ----------------------------------------------------
        #  アクセスログ管理ツールアクセス時パスワード
        #  暗号化キー
        # ----------------------------------------------------
        #  アクセスログ管理ツールのパスワードを暗号化する時
        #  の暗号カギです。
        #  他人から盗まれないよう注意してください。
        # ----------------------------------------------------
        #  英数字（ASCII)4桁〜16桁で指定してください。
        # ===========================================================
        $CriptKey = 'password_key';
        ..
        ..
</code></pre>
<ul>
	<li>上記以外の箇所は編集しないでください。（Perlでプログラムできる人は除く）
	<li>勢いあまって、<span>ダッシュ（’）イコール（＝）やセミコロン（；）</span>などを消してしまわないように<span>ご注意</span>ください
</ul>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">Perlを使用する時のおまじない行の編集  [ zcounter2.cgi / zc2adm.cgi ]</h3>
<ul>
	<li>自分のホームページがあるサーバーのPerlへのパスを指定します。Perlへのパスは、ホームページを置いているサーバー管理者に聞いてください。
	<li>編集するのは、以下の2本です。いづれも先頭行のみです。
	<ol>
		<li>Ｚカウンター２号CGI本体プログラム [ zcounter2.cgi ] 
		<li>アクセスログ管理CGI本体プログラム [ zc2adm.cgi ] 
	</ol>
	<li>上記のプログラムファイルをメモ帳などのテキストエディタで開いて編集します。
</ul>
<pre><code>
    ==== zcounter2.cgi ====

        #!/usr/bin/perl         <==== 先頭行です。
        ..
        ..
</code></pre>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">サーバにアップロード</h3>
<ul>
	<li>自分のホームページがあるサーバーにディレクトリ・ファイル構成に気をつけてアップしてください。（普通にFTPでアップする手順でOKと思います。）
	<li>但し、サーバーの漢字コードに注意してください。例えば、ローカルなPCがWindowsで、サーバーがUNIXやLinuxの場合は、FTP転送時に漢字コード変換が必要になります（必要ない場合もあるが、、）。よく分からない人は、ホームページを置いているサーバー管理者に相談してください。
	<li>漢字コード変換が必要な場合は、以下に従ってアップしてください。
</ul>
<pre>
        ./zcounter2.cgi          ---  漢字コード変換が必要です。[ FTP アスキー転送モード ]
        ./zc2adm.cgi             ---  漢字コード変換が必要です。[ FTP アスキー転送モード ]
        ./userdef.pm             ---  漢字コード変換が必要です。[ FTP アスキー転送モード ]
        ./lib/zcounter2.pm       ---  漢字コード変換が必要です。[ FTP アスキー転送モード ]
        ./lib/zc2adm.pm          ---  漢字コード変換が必要です。[ FTP アスキー転送モード ]
        ./lib/zcgi.pm            ---  漢字コード変換が必要です。[ FTP アスキー転送モード ]
        ./lib/jcode.pl           ---  漢字コード変換が必要です。[ FTP アスキー転送モード ]
        ./lib/gifcat.pl          ---  漢字コード変換が必要です。[ FTP アスキー転送モード ]
        ./counter_img/zero.gif   ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/one.gif    ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/two.gif    ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/three.gif  ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/four.gif   ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/five.gif   ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/six.gif    ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/seven.gif  ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/eight.gif  ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./counter_img/nine.gif   ---  変換は不要です。          [ FTP バイナリ転送モード ]
        ./data/error.gif         ---  変換は不要です。          [ FTP バイナリ転送モード ]
</pre>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">実行権、書込権の付与</h3>
<ul>
	<li>サーバー上のCGIが動作できるように、CGIスクリプトの実行権と、ファイルへの書込み権を設定します。
	<li>サーバーにアップしたファイルやディレクトリの属性を、以下のとおりに変更してください。
</ul>
<pre>
        ./zcounter2.cgi          ---  rwxr-xr-x [ 755 ]
        ./zc2adm.cgi             ---  rwxr-xr-x [ 755 ]
        ./userdef.pm             ---  rw-r--r-- [ 644 ]
        ./lib/                   ---  rwxr-xr-x [ 755 ]
        ./lib/zcounter2.pm       ---  rw-r--r-- [ 644 ]
        ./lib/zc2adm.pm          ---  rw-r--r-- [ 644 ]
        ./lib/zcgi.pm            ---  rw-r--r-- [ 644 ]
        ./lib/jcode.pl           ---  rw-r--r-- [ 644 ]
        ./lib/gifcat.pl          ---  rw-r--r-- [ 644 ]
        ./counter_img/           ---  rwxr-xr-x [ 755 ]
        ./counter_img/zero.gif   ---  rw-r--r-- [ 644 ]
        ./counter_img/one.gif    ---  rw-r--r-- [ 644 ]
        ./counter_img/two.gif    ---  rw-r--r-- [ 644 ]
        ./counter_img/three.gif  ---  rw-r--r-- [ 644 ]
        ./counter_img/four.gif   ---  rw-r--r-- [ 644 ]
        ./counter_img/five.gif   ---  rw-r--r-- [ 644 ]
        ./counter_img/six.gif    ---  rw-r--r-- [ 644 ]
        ./counter_img/seven.gif  ---  rw-r--r-- [ 644 ]
        ./counter_img/eight.gif  ---  rw-r--r-- [ 644 ]
        ./counter_img/nine.gif   ---  rw-r--r-- [ 644 ]
        ./data/                  ---  rwxrwxrwx [ 777 ]
        ./data/error.gif         ---  rw-r--r-- [ 644 ]
</pre>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">ページへの組み込み</h3>
<ul>
	<li>カウンターを表示したいページに次のタグを組み込みます。
	<li>&lt;IMG SRC="--cgiへのURL--/zcounter2.cgi"&gt;
	<li>例えば、相対的なパスで<strong> " cgi-bin/counter/ "</strong> に設置した場合
		<strong>&lt;IMG SRC="cgi-bin/counter/zcounter2.cgi"&gt;</strong>となります。
</ul>
<br>
<!-- ============================================================================================= -->
<h3 class="blue">管理メニューの動作確認</h3>
<ul>
	<li>管理メニューの動作テストを行います。
	<li>ブラウザから次のURLでアクセスしてみましょう。
	<li>http://--cgiへのURL--/zc2adm.cgi
	<li>例えば、"cgi-bin/counter/ " に設置した場合 http://サーバ・ホーム/cgi-bin/counter/zc2adm.cgiとなります。 
	<li>最初に認証パスワードを聞いてくるはずです。userdef.pm で定義したパスワードを入力してください。
	<li>認証が成功すれば管理メニューが表示されると思います。
	<li>うまく動作したら、成功です。
	<li>管理メニューは、他のページからリンクするか、或いは、管理者専用ですので、ブラウザのお気に入りにでも登録してアクセスしてもいいと思います。
</ul>
<!-- ============================================================================================= -->
</div>

<p>
●うーん、、わからん！うごかない！などのご質問は掲示板に！<br>
●と、いいたいところですが、現在掲示板の準備中ですので、しばらくお待ちください。<br>
</p>

<address>
[ <a class="magenda" href="/">HOME</a> ]
[ <a class="magenda" href="index.html">戻る</a> ]
</address>

</body>
</html>
